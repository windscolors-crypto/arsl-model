<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Shell Voice - ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Cairo', sans-serif;
            background: #0a0a1a;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .app { max-width: 500px; margin: 0 auto; padding: 10px; }

        .header {
            text-align: center; padding: 12px;
            background: linear-gradient(135deg, #1a1a3e, #0d0d2b);
            border-bottom: 2px solid #00d4aa;
            border-radius: 12px; margin-bottom: 8px;
        }
        .header h1 { font-size: 1.3em; color: #00d4aa; }
        .header p { font-size: 0.8em; color: #888; margin-top: 4px; }

        .mode-row { display: flex; justify-content: center; gap: 6px; margin-bottom: 8px; }
        .mode-btn {
            padding: 6px 16px; border: 1px solid #333;
            background: transparent; color: #888; border-radius: 20px;
            font-size: 0.8em; cursor: pointer; font-family: 'Cairo', sans-serif;
        }
        .mode-btn.active { background: #00d4aa; color: #000; border-color: #00d4aa; font-weight: bold; }

        .cam-wrap {
            position: relative; width: 100%; border-radius: 16px;
            overflow: hidden; border: 3px solid #222; margin-bottom: 8px;
            transition: border-color 0.3s;
        }
        .cam-wrap.rec-active { border-color: #ff4444; }
        #video { width: 100%; display: block; transform: scaleX(-1); }

        .badge {
            position: absolute; top: 10px; left: 10px;
            padding: 5px 12px; border-radius: 20px;
            font-size: 0.8em; font-weight: bold; z-index: 5;
        }
        .badge-yes { background: rgba(0,212,170,0.9); color: #000; }
        .badge-no { background: rgba(255,60,60,0.8); color: #fff; }

        .flip-btn {
            position: absolute; top: 10px; right: 10px;
            background: rgba(42,42,74,0.85); color: #fff; border: none;
            padding: 6px 12px; border-radius: 20px; cursor: pointer;
            font-size: 1.1em; z-index: 10;
        }
        .rec-tag {
            position: absolute; bottom: 16px; left: 50%; transform: translateX(-50%);
            background: rgba(255,68,68,0.9); color: #fff;
            padding: 4px 16px; border-radius: 15px;
            font-size: 0.8em; font-weight: bold; display: none;
        }
        .frame-tag {
            position: absolute; bottom: 16px; right: 10px;
            background: rgba(0,0,0,0.6); color: #aaa;
            padding: 3px 10px; border-radius: 10px;
            font-size: 0.75em; display: none;
        }

        .prog-wrap { width: 100%; height: 6px; background: #111; border-radius: 3px; overflow: hidden; margin-bottom: 8px; }
        .prog-fill {
            height: 100%; width: 0%;
            background: linear-gradient(90deg, #00d4aa, #00ff88);
            transition: width 0.1s; border-radius: 3px;
        }
        .prog-fill.rec-bar { background: linear-gradient(90deg, #ff4444, #ff6666); }

        .controls { display: flex; justify-content: center; padding: 8px; }
        .rec-btn {
            width: 68px; height: 68px; border-radius: 50%;
            border: 4px solid #00d4aa; background: transparent;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .rec-dot {
            width: 48px; height: 48px; border-radius: 50%;
            background: #00d4aa; transition: all 0.3s;
        }
        .rec-btn.on { border-color: #ff4444; }
        .rec-btn.on .rec-dot { width: 28px; height: 28px; border-radius: 6px; background: #ff4444; }
        .rec-hint { text-align: center; font-size: 0.8em; color: #666; margin-bottom: 8px; }

        .result {
            background: #111; border: 2px solid #222; border-radius: 16px;
            padding: 16px; text-align: center; margin-bottom: 8px;
            transition: border-color 0.3s;
        }
        .result.ok { border-color: #00d4aa; }
        .r-placeholder { font-size: 1.1em; color: #555; }
        .r-word { font-size: 2.5em; font-weight: 800; color: #00d4aa; display: none; }
        .r-eng { font-size: 1em; color: #888; margin-top: 2px; display: none; }
        .r-conf { margin-top: 8px; display: none; }
        .r-conf-text { font-size: 0.85em; color: #666; }
        .r-conf-bar { width: 70%; height: 6px; background: #222; border-radius: 3px; margin: 4px auto; overflow: hidden; }
        .r-conf-fill { height: 100%; width: 0%; border-radius: 3px; transition: width 0.3s; }

        .sent-box {
            background: #0d0d2b; border: 1px solid #333; border-radius: 12px;
            padding: 12px; min-height: 48px; font-size: 1.3em;
            direction: rtl; word-wrap: break-word; margin-bottom: 8px;
        }
        .btn-row { display: flex; gap: 6px; justify-content: center; flex-wrap: wrap; margin-bottom: 8px; }
        .btn {
            padding: 8px 16px; border: none; border-radius: 8px;
            font-size: 0.85em; font-weight: 700; cursor: pointer;
            font-family: 'Cairo', sans-serif;
        }
        .btn:active { transform: scale(0.95); }
        .b-add { background: #00d4aa; color: #000; }
        .b-space { background: #2a2a4a; color: #fff; }
        .b-del { background: #ff4444; color: #fff; }
        .b-clr { background: #333; color: #fff; }
        .b-speak { background: #4488ff; color: #fff; }

        .loading {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: #0a0a1a; display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 999;
        }
        .spin {
            width: 50px; height: 50px; border: 4px solid #222;
            border-top-color: #00d4aa; border-radius: 50%;
            animation: sp 1s linear infinite;
        }
        @keyframes sp { to { transform: rotate(360deg); } }
        .load-msg { margin-top: 16px; color: #aaa; }
        .load-detail { color: #555; font-size: 0.8em; margin-top: 6px; }
        .status { text-align: center; font-size: 0.7em; color: #444; padding: 6px; }
    </style>
</head>
<body>

<div class="loading" id="loader">
    <div class="spin"></div>
    <div class="load-msg">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Shell Voice...</div>
    <div class="load-detail" id="loadMsg">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬...</div>
</div>

<div class="app">
    <div class="header">
        <h1>ğŸš Shell Voice</h1>
        <p>ØªØ±Ø¬Ù…Ø© Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</p>
    </div>

    <div class="mode-row">
        <button class="mode-btn active" id="btnManual">ÙŠØ¯ÙˆÙŠ ğŸ”´</button>
        <button class="mode-btn" id="btnAuto">ØªÙ„Ù‚Ø§Ø¦ÙŠ â™»ï¸</button>
    </div>

    <div class="cam-wrap" id="camWrap">
        <video id="video" autoplay playsinline></video>
        <button class="flip-btn" id="flipBtn">ğŸ”„</button>
        <div class="badge badge-no" id="handBadge">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙŠØ¯ âœ‹</div>
        <div class="rec-tag" id="recTag">âº ØªØ³Ø¬ÙŠÙ„...</div>
        <div class="frame-tag" id="frameTag">0/30</div>
    </div>

    <div class="prog-wrap"><div class="prog-fill" id="progBar"></div></div>

    <div class="rec-hint" id="recHint">Ø§Ø¶ØºØ·ÙŠ Ø§Ù„Ø²Ø± Ø«Ù… Ø§Ø¹Ù…Ù„ÙŠ Ø¥Ø´Ø§Ø±Ø© Ø§Ù„ÙƒÙ„Ù…Ø©</div>
    <div class="controls" id="ctrlDiv">
        <button class="rec-btn" id="recBtn"><div class="rec-dot"></div></button>
    </div>

    <div class="result" id="resCard">
        <div class="r-placeholder" id="resHolder">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§</div>
        <div class="r-word" id="resWord"></div>
        <div class="r-eng" id="resEng"></div>
        <div class="r-conf" id="resConf">
            <div class="r-conf-text" id="confTxt"></div>
            <div class="r-conf-bar"><div class="r-conf-fill" id="confBar"></div></div>
        </div>
    </div>

    <div class="sent-box" id="sentBox"></div>
    <div class="btn-row">
        <button class="btn b-add" id="addBtn">Ø¥Ø¶Ø§ÙØ© â•</button>
        <button class="btn b-space" id="spaceBtn">Ù…Ø³Ø§ÙØ©</button>
        <button class="btn b-del" id="delBtn">Ø­Ø°Ù â¬…</button>
        <button class="btn b-clr" id="clrBtn">Ù…Ø³Ø­</button>
        <button class="btn b-speak" id="speakBtn">Ù†Ø·Ù‚ ğŸ”Š</button>
    </div>

    <div class="status" id="statusBar">Shell Voice v1.0</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1675469240/hands.min.js"></script>

<script>
// ========== CONFIG ==========
const MODEL_URL = 'word_model.json';
const CLASSES_URL = 'word_classes.json';
const NUM_FRAMES = 30;
const TOTAL_VALUES = 126;

const ARABIC_MAP = {
    '0':'Ù  ØµÙØ±','1':'Ù¡ ÙˆØ§Ø­Ø¯','2':'Ù¢ Ø§Ø«Ù†Ø§Ù†','3':'Ù£ Ø«Ù„Ø§Ø«Ø©','4':'Ù¤ Ø£Ø±Ø¨Ø¹Ø©',
    'eat':'ÙŠØ£ÙƒÙ„','drink':'ÙŠØ´Ø±Ø¨','sleep':'ÙŠÙ†Ø§Ù…','wakeup':'ÙŠØ³ØªÙŠÙ‚Ø¸',
    'sit':'ÙŠØ¬Ù„Ø³','stand':'ÙŠÙ‚Ù','love':'Ø­Ø¨','take':'ÙŠØ£Ø®Ø°',
    'help':'Ù…Ø³Ø§Ø¹Ø¯Ø©','think':'ÙŠÙÙƒØ±','choose':'ÙŠØ®ØªØ§Ø±',
    'father':'Ø£Ø¨','mother':'Ø£Ù…','family':'Ø¹Ø§Ø¦Ù„Ø©','brother':'Ø£Ø®',
    'grandfather':'Ø¬Ø¯','grandmother':'Ø¬Ø¯Ø©',
    'hearing_disability':'Ø¥Ø¹Ø§Ù‚Ø© Ø³Ù…Ø¹ÙŠØ©','health':'ØµØ­Ø©','silence':'ØµÙ…Øª'
};

// ========== STATE ==========
let model=null, classNames=[], hands=null;
let isRec=false, frames=[], curResult='', sentence='';
let facing='user', autoMode=false, autoFrames=[], handOn=false, noHand=0;

const video = document.getElementById('video');
const loadMsg = document.getElementById('loadMsg');

// ========== FIX & LOAD MODEL ==========
// Fix Keras 3 batch_shape â†’ batch_input_shape by intercepting fetch
function fixBatchShape(obj) {
    if (!obj || typeof obj !== 'object') return;
    if (Array.isArray(obj)) { obj.forEach(fixBatchShape); return; }
    if (obj.class_name === 'InputLayer' && obj.config) {
        if (obj.config.batch_shape && !obj.config.batch_input_shape) {
            obj.config.batch_input_shape = obj.config.batch_shape;
            delete obj.config.batch_shape;
            console.log('âœ… Fixed batch_shape â†’ batch_input_shape');
        }
    }
    for (let k of Object.keys(obj)) {
        if (typeof obj[k] === 'object') fixBatchShape(obj[k]);
    }
}

async function loadModel() {
    // 1. Load class names
    loadMsg.textContent = 'ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª...';
    try {
        const r = await fetch(CLASSES_URL);
        classNames = await r.json();
        console.log('âœ… Classes loaded:', classNames.length);
    } catch(e) {
        loadMsg.textContent = 'âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª';
        return false;
    }

    // 2. Load model - intercept fetch to fix JSON on the fly
    loadMsg.textContent = 'ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ÙƒÙ„Ù…Ø§Øª...';
    
    const originalFetch = window.fetch;
    
    window.fetch = async function(url, options) {
        const response = await originalFetch.call(window, url, options);
        
        // Intercept word_model.json to fix batch_shape
        if (typeof url === 'string' && url.includes('word_model.json')) {
            const json = await response.json();
            console.log('ğŸ”§ Intercepted word_model.json, fixing...');
            
            if (json.modelTopology) {
                fixBatchShape(json.modelTopology);
            }
            
            // Return fixed JSON as new Response
            return new Response(JSON.stringify(json), {
                status: 200,
                statusText: 'OK',
                headers: { 'Content-Type': 'application/json' }
            });
        }
        
        return response;
    };

    try {
        model = await tf.loadLayersModel(MODEL_URL);
        console.log('âœ… Model loaded! Input shape:', model.inputs[0].shape);
        
        // Restore original fetch
        window.fetch = originalFetch;
        return true;
    } catch(e) {
        console.error('âŒ Model load failed:', e);
        window.fetch = originalFetch;
        loadMsg.textContent = 'âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬: ' + e.message;
        return false;
    }
}

// ========== MEDIAPIPE ==========
async function setupHands() {
    loadMsg.textContent = 'ØªØ­Ù…ÙŠÙ„ MediaPipe...';
    hands = new Hands({
        locateFile: f => 'https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1675469240/' + f
    });
    hands.setOptions({ maxNumHands:2, modelComplexity:1, minDetectionConfidence:0.5, minTrackingConfidence:0.5 });
    hands.onResults(onHands);
}

function getLM(results) {
    let lm = new Array(TOTAL_VALUES).fill(0);
    if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
        const h1 = results.multiHandLandmarks[0];
        for (let i=0;i<21;i++) { lm[i*3]=h1[i].x; lm[i*3+1]=h1[i].y; lm[i*3+2]=h1[i].z; }
        if (results.multiHandLandmarks.length > 1) {
            const h2 = results.multiHandLandmarks[1];
            for (let i=0;i<21;i++) { lm[63+i*3]=h2[i].x; lm[63+i*3+1]=h2[i].y; lm[63+i*3+2]=h2[i].z; }
        }
        return { lm, ok:true };
    }
    return { lm, ok:false };
}

function onHands(results) {
    const { lm, ok } = getLM(results);
    handOn = ok;
    const badge = document.getElementById('handBadge');
    if (ok) {
        badge.textContent = 'ÙŠØ¯ Ù…ÙƒØªØ´ÙØ© âœ…'; badge.className = 'badge badge-yes'; noHand=0;
    } else {
        badge.textContent = 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙŠØ¯ âœ‹'; badge.className = 'badge badge-no'; noHand++;
    }

    // Manual
    if (isRec && ok) {
        frames.push(lm);
        document.getElementById('progBar').style.width = (frames.length/NUM_FRAMES*100)+'%';
        document.getElementById('frameTag').style.display = 'block';
        document.getElementById('frameTag').textContent = frames.length+'/'+NUM_FRAMES;
        if (frames.length >= NUM_FRAMES) stopRec();
    }

    // Auto
    if (autoMode) {
        const tag=document.getElementById('recTag'), bar=document.getElementById('progBar');
        if (ok) {
            autoFrames.push(lm);
            bar.style.width = (autoFrames.length/NUM_FRAMES*100)+'%';
            tag.style.display='block'; tag.textContent='âº '+autoFrames.length+'/'+NUM_FRAMES;
            if (autoFrames.length>=NUM_FRAMES) {
                doPredict(autoFrames); autoFrames=[];
                tag.style.display='none'; bar.style.width='0%';
            }
        } else if (noHand>10 && autoFrames.length>=NUM_FRAMES/2) {
            while(autoFrames.length<NUM_FRAMES) autoFrames.push(new Array(TOTAL_VALUES).fill(0));
            doPredict(autoFrames); autoFrames=[];
            tag.style.display='none'; bar.style.width='0%';
        } else if (noHand>20) {
            autoFrames=[]; bar.style.width='0%'; tag.style.display='none';
        }
    }
}

// ========== PREDICT ==========
async function doPredict(buf) {
    if (!model||buf.length===0) return;
    try {
        let f=buf.slice(0,NUM_FRAMES);
        while(f.length<NUM_FRAMES) f.push(new Array(TOTAL_VALUES).fill(0));

        const inp=tf.tensor3d([f],[1,NUM_FRAMES,TOTAL_VALUES]);
        const pred=model.predict(inp);
        const probs=await pred.data();

        let mi=0,mp=0;
        for(let i=0;i<probs.length;i++) if(probs[i]>mp){mp=probs[i];mi=i;}

        const eng=classNames[mi], conf=mp, ar=ARABIC_MAP[eng]||eng;
        const pct=(conf*100).toFixed(1);

        document.getElementById('resHolder').style.display='none';
        const w=document.getElementById('resWord'); w.style.display='block'; w.textContent=ar;
        const e2=document.getElementById('resEng'); e2.style.display='block'; e2.textContent=eng;
        document.getElementById('resConf').style.display='block';
        document.getElementById('confTxt').textContent='Ø§Ù„Ø«Ù‚Ø©: '+pct+'%';
        const cb=document.getElementById('confBar'); cb.style.width=pct+'%';

        if(conf>=0.55) {
            curResult=ar; w.style.color='#00d4aa';
            document.getElementById('resCard').classList.add('ok');
            cb.style.background=conf>=0.8?'linear-gradient(90deg,#00d4aa,#00ff88)':'linear-gradient(90deg,#ffaa00,#ffcc00)';
        } else {
            w.style.color='#ff8800';
            document.getElementById('resCard').classList.remove('ok');
            cb.style.background='linear-gradient(90deg,#ff4444,#ff6666)';
        }
        inp.dispose(); pred.dispose();
    } catch(err) {
        console.error('Predict err:', err);
        document.getElementById('statusBar').textContent='âŒ '+err.message;
    }
}

// ========== RECORDING ==========
function startRec() {
    if(!model) return;
    frames=[]; isRec=true;
    document.getElementById('recBtn').classList.add('on');
    document.getElementById('camWrap').classList.add('rec-active');
    document.getElementById('progBar').classList.add('rec-bar');
    document.getElementById('progBar').style.width='0%';
    document.getElementById('recHint').textContent='Ø§Ø¹Ù…Ù„ÙŠ Ø§Ù„Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¢Ù†...';
    document.getElementById('frameTag').style.display='block';
    document.getElementById('frameTag').textContent='0/'+NUM_FRAMES;
    document.getElementById('recTag').style.display='block';
    document.getElementById('recTag').textContent='âº Ø§Ø¹Ù…Ù„ÙŠ Ø§Ù„Ø¥Ø´Ø§Ø±Ø©...';
    document.getElementById('resHolder').style.display='block';
    document.getElementById('resHolder').textContent='ğŸ¤š Ø§Ø¹Ù…Ù„ÙŠ Ø§Ù„Ø¥Ø´Ø§Ø±Ø©...';
    document.getElementById('resWord').style.display='none';
    document.getElementById('resEng').style.display='none';
    document.getElementById('resConf').style.display='none';
    document.getElementById('resCard').classList.remove('ok');
}

function stopRec() {
    isRec=false;
    document.getElementById('recBtn').classList.remove('on');
    document.getElementById('camWrap').classList.remove('rec-active');
    document.getElementById('progBar').classList.remove('rec-bar');
    document.getElementById('recTag').style.display='none';
    document.getElementById('frameTag').style.display='none';
    document.getElementById('recHint').textContent='Ø§Ø¶ØºØ·ÙŠ Ø§Ù„Ø²Ø± Ù„ØªØ³Ø¬ÙŠÙ„ Ø¥Ø´Ø§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©';
    if(frames.length>0) {
        document.getElementById('resHolder').textContent='Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...';
        doPredict(frames);
    }
}

// ========== CAMERA ==========
async function setupCam() {
    loadMsg.textContent = 'ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§...';
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode:facing, width:640, height:480 }
        });
        video.srcObject = stream;
        await new Promise(r => video.onloadedmetadata=r);
        async function loop() {
            if(video.readyState>=2) await hands.send({image:video});
            requestAnimationFrame(loop);
        }
        loop();
        return true;
    } catch(e) {
        loadMsg.textContent='âŒ Ø®Ø·Ø£ Ø¨Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§: '+e.message;
        return false;
    }
}

// ========== EVENTS ==========
document.getElementById('recBtn').addEventListener('click', () => {
    if(autoMode) return; isRec ? stopRec() : startRec();
});
document.getElementById('flipBtn').addEventListener('click', async () => {
    facing=facing==='user'?'environment':'user';
    video.style.transform=facing==='user'?'scaleX(-1)':'scaleX(1)';
    if(video.srcObject) video.srcObject.getTracks().forEach(t=>t.stop());
    await setupCam();
});
document.getElementById('addBtn').addEventListener('click', () => {
    if(curResult){sentence+=curResult; document.getElementById('sentBox').textContent=sentence;}
});
document.getElementById('spaceBtn').addEventListener('click', () => {
    sentence+=' '; document.getElementById('sentBox').textContent=sentence;
});
document.getElementById('delBtn').addEventListener('click', () => {
    sentence=sentence.slice(0,-1); document.getElementById('sentBox').textContent=sentence;
});
document.getElementById('clrBtn').addEventListener('click', () => {
    sentence=''; document.getElementById('sentBox').textContent='';
});
document.getElementById('speakBtn').addEventListener('click', () => {
    if(sentence&&'speechSynthesis'in window){
        const u=new SpeechSynthesisUtterance(sentence); u.lang='ar-SA'; speechSynthesis.speak(u);
    }
});
document.getElementById('btnManual').addEventListener('click', () => {
    autoMode=false;
    document.getElementById('btnManual').classList.add('active');
    document.getElementById('btnAuto').classList.remove('active');
    document.getElementById('ctrlDiv').style.display='flex';
    document.getElementById('recHint').style.display='block';
    autoFrames=[]; document.getElementById('recTag').style.display='none';
    document.getElementById('progBar').style.width='0%';
});
document.getElementById('btnAuto').addEventListener('click', () => {
    autoMode=true;
    document.getElementById('btnAuto').classList.add('active');
    document.getElementById('btnManual').classList.remove('active');
    document.getElementById('ctrlDiv').style.display='none';
    document.getElementById('recHint').style.display='none';
    autoFrames=[];
});

// ========== INIT ==========
async function init() {
    const ok = await loadModel();
    if(!ok) { document.getElementById('statusBar').textContent='âŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„'; return; }
    await setupHands();
    const cam = await setupCam();
    if(cam) {
        document.getElementById('loader').style.display='none';
        document.getElementById('statusBar').textContent='âœ… Ø¬Ø§Ù‡Ø² - '+classNames.length+' ÙƒÙ„Ù…Ø©';
    }
}
init();
</script>
</body>
</html>
